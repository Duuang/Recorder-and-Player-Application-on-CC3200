# Recorder-and-Player-Application-on-CC3200

基于CC3200的录音和播放程序

具体文档未上传

**四、 使用的相关模块、样例、算法**

1. 使用的模块：
CC3200开发板、DY-IOT-PB扩展板、DY-IOT-Voice模块
2. 参考的样例：
（1）CC3200板子做AP、TCP通信：ControlLED(Getting started with WLAN AP)、wlan_ap
（2）麦克风模块和ADC采样：LCD_Voice、adc
（3）CC3200文件操作：file_operations
（4）LCD屏幕显示：lcd_test
（5）串口通信：uart_demo
3. 关键算法：
（1）基于时间戳的固定频率采样算法
（2）对声音信号的均值滤波算法
（3）WAV文件编码算法

**五、实现的具体功能**
	通过CC3200、配套的DY-IOT-PB，以及DY-IOT-Voice麦克风模块，实现了：
1. 下位机CC3200：
作为AP运行，可以被安卓手机APP控制，进行录音、下载录音并播放的功能，具体为：

（1）使用LCD模块，能直观显示CC3200目前运行状态和正在进行的工作，便于操控

（2）手机连上AP之后，可以通过TCP协议发送数据包给CC3200开发板，CC3200接收后，根据手机控制信号决定要进行的操作（操作1/操作2）。

（3）操作1：录音。手机按“开始录音键”，开始录音，具体过程为：
① 采样：先通过DY-IOT-Voice麦克风模块进行声音信号的接收，并通过板载的ADC来按设定的固定频率（程序中为4kHz，可调整）进行采样（固定频率采样是通过读采样数据中的时间戳来进行的），并存储在内存中
② 采样数据处理：读取采样值中的数据部分，并做均值滤波（加上周围的2n个然后取平均），均值的样本范围可调整，做了多次试验，发现n=30的话效果较好
③ 保存到文件：根据sdk中file_operations改，用sl_FsWrite() 函数将处理后的数据，并按照WAV编码格式（处理文件头），写入文件，存在CC3200的Flash中
④ LCD显示operation success信息，并返回standby界面

（4）操作2：将音频上传到上位机并播放。（因为那个立体声模块太复杂，又没有样例，所以放弃了在下位机播放，做的是把音频文件上传到上位机并在上位机播放）
① 用sl_FsRead()，读文件，LCD显示sending
② 将文件通过串口发送出去（电脑接收后存起来，就可以播放了）
③ 发送完成LCD显示operation success信息，返回standby界面

2. 上位机： 安卓手机端APP
通过APP，先选择客户端，再点“连接”，再点“录音”或“下载录音”即可控制CC3200开发板进行操作1（录音）或操作2（传输录音）。
 
3. 上位机：PC端
    可以通过PC端的串口接收程序，来接收CC3200通过串口发出的音频文件，将接收到的数据以文件形式存储在PC上，并可以播放。
